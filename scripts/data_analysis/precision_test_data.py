#!/usr/bin/env python
# -*- coding: utf-8 -*-

import sys
import copy
import rospy
import ikpy
import numpy as np
import ikpy.utils.plot as plot_utils
from math import pi

M1_MIN = -3.1415
M1_MAX = 3.1415
M2_MIN = -3.1415
M2_MAX = 0
M3_MIN = -1.68
M3_MAX = 2.5
M4_MIN = -3.1415/2
M4_MAX = 3.1415/2
M_MIN = [M1_MIN, M2_MIN, M3_MIN, M4_MIN]
M_MAX = [M1_MAX, M2_MAX, M3_MAX, M4_MAX]

ALLOWABLE_ERROR = 0.0000001

URDF_PATH = "./src/agrobot_arm_v2/urdf/agrobot_arm_v2.urdf"
arm_chain = ikpy.chain.Chain.from_urdf_file(URDF_PATH)
actual_position = arm_chain.forward_kinematics([0, 1.17895017929351, -1.29072251468681, -0.467185277782668, 0])
print(actual_position[:, 3])

# actual position = [0.149987, 0.1565, 0.34745)
# target_position = [0.15, 0.2, 0.3]
# actual: 1.1439815874469, -1.24430965641769, -0.453246748165493
# target: 1.218388820363999, -1.3870928376425722, -0.5034230234823038

# Test 1 PD = 30, 1.0 accuracy
# actual position = [0.14967656, 0.17610252, 0.33045223]
# Actual: 1.18200198367285, -1.30051372040386, -0.469304586379432

# Test 2 PD = 40, 1.25 acc
# actual position = [0.14944271, 0.17262568, 0.33247178]
# Actual: 1.17691564304061, -1.29008672210778, -0.470119705070495

# Test 3 PD = 40, 1.3 acc
# actual position = [0.15118418 0.17129104 0.33135297]
# Actual: 1.16712443732357, -1.29123114875003, -0.472891108620108

# Test 4 PD = 50, 1.4 acc
# actual position = [0.14972542 0.17497435 0.33057974]
# Actual: 1.17984028890415, -1.29771623305613, -0.470853311892451

# Test 1 PD = 30, 1.0 prec
# xyz position = [0.14929091, 0.17283525, 0.33301178
# Actual: 1.17793291116706, -1.28995956359197, -0.468489467688369

# Test 2 PD = 30, 1.0 prec
# xyz position = [0.15223366 0.17897055 0.32808891]
# Actual: 1.17627985046159, -1.3146283156583, -0.466859230306243

# Test 3 PD = 30, 1.0 prec
# xyz = [0.15029267 0.17039062 0.33394835]
# Actual: 1.16928613209227, -1.28550901553877, -0.468570979557475

# Test 4 PD = 30, 1.0 prec
# xyz = [0.14930959 0.17259251 0.33291701]
# Actual: 1.17742427710384, -1.28945092952875, -0.469141562641219

# Test 5 PD = 30, 1.0 prec
# xyz = [0.14953891 0.1731451  0.33180178]
# Actual: 1.17742427710384, -1.29199409984487, -0.470934823761558

# Test 6
# xyz = 0.15018608 0.17233016 0.33372555
# Actual: 1.17322804608225, -1.29021388062359, -0.466044111615181

# Test 7
# xyz = 0.14937693 0.17369333 0.33222486
# Actual: 1.17907733780931, -1.2927570509397, -0.469060050772113

# Test 8
# xyz = 0.14884522 0.17305577 0.33296634
# Actual: 1.18022176445157, -1.28957808804456, -0.468897027033901

# Test 9
# xyz = 0.14978802 0.17607976 0.32933652
# Actual = 1.18149334960962, -1.3014038300145, -0.472239013667258

# Test 10
# xyz = 0.14922589 0.17325536 0.33325628
# Actual = 1.17895017929351, -1.29072251468681, -0.467185277782668